abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm2$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "deviance", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "pearson"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm2$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "pearson", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "pearson"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2, type = "pearson"), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "pearson", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "pearson"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2, type = "deviance"), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "pearson", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "pearson"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm2$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "pearson", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "pearson"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm2$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "deviance", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "deviance"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2, type = "deviance"), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, type = "deviance", rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2, type = "deviance"), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm3$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm3), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm3$na.action, mod.glm3$linear.predictors),
residuals(mod.glm3), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals")
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm3$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm3), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80")
plot(napredict(mod.glm3$na.action, mod.glm3$linear.predictors),
residuals(mod.glm3), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm3$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm3), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm3$na.action, mod.glm3$linear.predictors),
residuals(mod.glm3), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80",main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",cex.main=0.9)
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm4$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm4), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm4$na.action, mod.glm4$linear.predictors),
residuals(mod.glm4), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
plot(mod.glm4,pages = 1,residuals = TRUE)
plot(mod.glm4, pages = 1,scheme = TRUE)
plot(mod.glm3,pages = 1,scheme = TRUE)
plot(mod.glm3,pages = 1, residuals = TRUE)
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm3,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm3,mod.glm2, test = "Chisq")
anova(mod.glm3,mod.glm4, test = "Chisq")
anova(mod.glm4,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm3,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "F")
anova(mod.glm1,mod.glm2, test = "F")
anova(mod.glm2,mod.glm3, test = "F")
anova(mod.glm2,mod.glm3, test = "Chisq")
?anova
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm4,mod.glm3, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "Chisq")
mod.glm3 <- gam(FGm12~Treatment+FGm0+s(FGm0), data = hirs, na.action = na.omit)
summary(mod.glm3)
vis.gam(mod.glm3,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
mod.glm3 <- gam(FGm12~Treatment+FGm0+s(FGm0), data = hirs, na.action = na.omit)
summary(mod.glm3)
mod.glm2 <- gam(FGm12~Treatment+s(FGm0), data = hirs)
summary(mod.glm2)
anova(mod.glm1,mod.glm2, test = "F")
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm4,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm3, test = "Chisq")
anova(mod.glm4,mod.glm3, test = "Chisq")
AIC(mod.glm1,mod.glm2,mod.glm3,mod.glm4)
BIC(mod.glm1,mod.glm2,mod.glm3,mod.glm4)
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
AIC(mod.glm1,mod.glm2,mod.glm4)
BIC(mod.glm1,mod.glm2,mod.glm4)
AIC(mod.glm1,mod.glm2,mod.glm4)
mod.glm4 <- gam(FGm12~Treatment+s(FGm0, SysPres), data = hirs, na.action = na.omit)
summary(mod.glm4)
vis.gam(mod.glm4,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
vis.gam(mod.glm4,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
emm<-emmeans(mod.glm1,~Treatment)
cld(emm)
plot(emm)
emm<-emmeans(mod.glm1,~Treatment+FGm0)
cld(emm)
plot(emm)
emm<-emmeans(mod.glm1,~Treatment)
cld(emm)
?emmeans
mod.glm0 <- lm(FGm12~Treatment, data = hirs)
summary(mod.glm0)
mod.glm1 <- lm(FGm12~Treatment+FGm0, data = hirs)
summary(mod.glm1)
anova(mod.glm0,mod.glm1, test = "F")
mod.glm2 <- gam(FGm12~Treatment+s(FGm0), data = hirs)
summary(mod.glm2)
mod.glm4 <- gam(FGm12~Treatment+s(FGm0, SysPres), data = hirs, na.action = na.omit)
summary(mod.glm4)
library(mgcv)
library(ggplot2)
library(rgl)
library(emmeans)
hirs <- read.table("hirsutism.dat",header=T, sep="\t",fill=TRUE)
hirs <- na.omit(hirs[,-c(3:4)])
str(hirs)
hirs$Treatment <- factor(hirs$Treatment)
summary(hirs)
cor <- round(cor(hirs[,2:7], use = "complete.obs"),2)
print(cor)
ggplot(hirs,aes(x=FGm0,y=FGm12))+
geom_point(aes(FGm0,FGm12), col=as.numeric(hirs$Treatment)+1)+
ggtitle(label="FGm12 vs FGm0 and Treatment")+
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method = "lm")
mod.glm0 <- lm(FGm12~Treatment, data = hirs)
summary(mod.glm0)
mod.glm1 <- lm(FGm12~Treatment+FGm0, data = hirs)
summary(mod.glm1)
anova(mod.glm0,mod.glm1, test = "F")
emm<-emmeans(mod.glm1,~Treatment)
cld(emm)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(0,0,0,0),mar=c(4,3,2,2))
plot(x=mod.glm1$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm1$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
plot(mod.glm1, which=c(1:2),
cex=0.5, cex.main=0.9,cex.lab=0.9,cex.axis=0.8,
sub.caption = "")
mod.glm1 <- gam(FGm12~Treatment+FGm0, data = hirs)
mod.glm2 <- gam(FGm12~Treatment+s(FGm0), data = hirs)
summary(mod.glm2)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80",main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",cex.main=0.9)
abline(h=0, lty=2, col="red")
mod.glm4 <- gam(FGm12~Treatment+s(FGm0, SysPres), data = hirs, na.action = na.omit)
summary(mod.glm4)
vis.gam(mod.glm4,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm4$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm4), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm4$na.action, mod.glm4$linear.predictors),
residuals(mod.glm4), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
vis.gam(mod.glm2,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
AIC(mod.glm1,mod.glm2,mod.glm4)
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
AIC(mod.glm1,mod.glm2,mod.glm4)
AIC(mod.glm1,mod.glm2,mod.glm4)
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm2,mod.glm4, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm4,mod.glm3, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm4,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm4,mod.glm2, test = "Chisq")
anova(mod.glm1,mod.glm2, test = "Chisq")
anova(mod.glm4,mod.glm2, test = "Chisq")
library(mgcv)
library(ggplot2)
library(rgl)
library(emmeans)
hirs <- read.table("hirsutism.dat",header=T, sep="\t",fill=TRUE)
hirs <- na.omit(hirs[,-c(3:4)])
str(hirs)
hirs$Treatment <- factor(hirs$Treatment)
summary(hirs)
ggplot(hirs,aes(x=FGm0,y=FGm12))+
geom_point(aes(FGm0,FGm12), col=as.numeric(hirs$Treatment)+1)+
ggtitle(label="FGm12 vs FGm0 and Treatment")+
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method = "lm")
mod.glm0 <- lm(FGm12~Treatment, data = hirs)
summary(mod.glm0)
mod.glm1 <- lm(FGm12~Treatment+FGm0, data = hirs)
summary(mod.glm1)
anova(mod.glm0,mod.glm1, test = "F")
emm<-emmeans(mod.glm1,~Treatment)
cld(emm)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(0,0,0,0),mar=c(4,3,2,2))
plot(x=mod.glm1$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = mod.glm1$residuals, freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
plot(mod.glm1, which=c(1:2),
cex=0.5, cex.main=0.9,cex.lab=0.9,cex.axis=0.8,
sub.caption = "")
mod.glm1 <- gam(FGm12~Treatment+FGm0, data = hirs)
mod.glm2 <- gam(FGm12~Treatment+s(FGm0), data = hirs)
summary(mod.glm2)
vis.gam(mod.glm2,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm2$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm2), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm2, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80",main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm2$na.action, mod.glm2$linear.predictors),
residuals(mod.glm2), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",cex.main=0.9)
abline(h=0, lty=2, col="red")
mod.glm4 <- gam(FGm12~Treatment+s(FGm0, SysPres), data = hirs, na.action = na.omit)
summary(mod.glm4)
vis.gam(mod.glm4,se=0,theta =40, phi = 10, d=4,nticks=3)
text(-.61,-.1,'RM',srt=90)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm4$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm4), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm3, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm4$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm4), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm4, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm4$na.action, mod.glm4$linear.predictors),
residuals(mod.glm4), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
par(mfrow=c(2,2), mgp=c(1.5,0.5,0),oma=c(1,0,1,0),mar=c(4,3,2,2))
plot(x=mod.glm4$fitted.values,y=hirs$FGm12, pch=18, cex=0.5,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9,
xlab = "Predicted FGm12",
ylab = "Orignal FGm12",
main = "Predicted vs. Original Values")
abline(a=0,b=1, col=2, lty=3)
hist(x = residuals(mod.glm4), freq = FALSE,
main = "Residuals histogram",
xlab = "Residuals",breaks = 15,
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
qq.gam(mod.glm4, rep = 0, level = 0.9, rl.col = 2,
rep.col = "gray80", main="Q-Q plot",cex.main=0.9)
plot(napredict(mod.glm4$na.action, mod.glm4$linear.predictors),
residuals(mod.glm4), main = "Resids vs. linear pred.",
xlab = "linear predictor", ylab = "residuals",
cex.lab=0.9,cex.axis=0.8,cex.main=0.9)
abline(h=0, lty=2, col="red")
